Test code by Shasthri
Updated by Sree valli
Changes made by Michael.
